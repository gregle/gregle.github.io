"use strict";function BingoCtrl(a){a.get("assets/phrases.json").then(function(a){b.bingoInfo=a.data,b.loadGrid()});var b=this;b.title="bingo",b.confetti=!1,b.grid=[[{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1}],[{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1}],[{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1}],[{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1}],[{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1},{phrase:"test",hit:!1}]],b.ShufflePhrases=function(){for(var a,c,d=b.bingoInfo.phrases.length;--d>0;)a=Math.floor(Math.random()*(d+1)),c=b.bingoInfo.phrases[a],b.bingoInfo.phrases[a]=b.bingoInfo.phrases[d],b.bingoInfo.phrases[d]=c},b.loadGrid=function(){b.ShufflePhrases();for(var a=0,c=0;c<b.grid.length;c++)for(var d=0;d<b.grid[c].length;d++)2===c&&2===d?(b.grid[c][d].phrase=b.bingoInfo.freeSpace,b.grid[c][d].hit=!0):(b.grid[c][d].phrase=b.bingoInfo.phrases[a],b.grid[c][d].hit=!1),a++},b.selectTile=function(a){a.phrase!==b.bingoInfo.freeSpace&&(a.hit=!a.hit),b.checkWin()&&b.celebration()},b.checkWin=function(){if(b.grid[0][0].hit&&b.grid[1][1].hit&&b.grid[2][2].hit&&b.grid[3][3].hit&&b.grid[4][4].hit)return!0;if(b.grid[0][4].hit&&b.grid[1][3].hit&&b.grid[2][2].hit&&b.grid[3][1].hit&&b.grid[4][0].hit)return!0;for(var a=0;a<b.grid.length;a++){if(b.grid[a][0].hit&&b.grid[a][1].hit&&b.grid[a][2].hit&&b.grid[a][3].hit&&b.grid[a][4].hit)return!0;if(b.grid[0][a].hit&&b.grid[1][a].hit&&b.grid[2][a].hit&&b.grid[3][a].hit&&b.grid[4][a].hit)return!0}return!1},b.celebration=function(){document.getElementById("audiotag1").play(),b.confetti=!0,StartConfetti()},b.reset=function(){b.confetti=!1,b.loadGrid()}}function StartConfetti(){function a(b,c){this.x=b,this.y=c,this.Length=function(){return sqrt(this.SqrLength())},this.SqrLength=function(){return this.x*this.x+this.y*this.y},this.Add=function(a){this.x+=a.x,this.y+=a.y},this.Sub=function(a){this.x-=a.x,this.y-=a.y},this.Div=function(a){this.x/=a,this.y/=a},this.Mul=function(a){this.x*=a,this.y*=a},this.Normalize=function(){var a=this.SqrLength();if(0!=a){var b=1/sqrt(a);this.x*=b,this.y*=b}},this.Normalized=function(){var b=this.SqrLength();if(0!=b){var c=1/sqrt(b);return new a(this.x*c,this.y*c)}return new a(0,0)}}function b(b,c,d,e){this.position=new a(b,c),this.mass=d,this.drag=e,this.force=new a(0,0),this.velocity=new a(0,0),this.AddForce=function(a){this.force.Add(a)},this.Integrate=function(b){var c=this.CurrentForce(this.position);c.Div(this.mass);var d=new a(this.velocity.x,this.velocity.y);d.Mul(b),this.position.Add(d),c.Mul(b),this.velocity.Add(c),this.force=new a(0,0)},this.CurrentForce=function(b,c){var d=new a(this.force.x,this.force.y),e=this.velocity.Length(),f=new a(this.velocity.x,this.velocity.y);return f.Mul(this.drag*this.mass*e),d.Sub(f),d}}function c(b,d){this.pos=new a(b,d),this.rotationSpeed=600*random()+800,this.angle=l*random()*360,this.rotation=l*random()*360,this.cosA=1,this.size=5,this.oscillationSpeed=1.5*random()+.5,this.xSpeed=40,this.ySpeed=60*random()+50,this.corners=new Array,this.time=random();var e=round(random()*(m.length-1));this.frontColor=m[e][0],this.backColor=m[e][1];for(var f=0;4>f;f++){var g=cos(this.angle+l*(90*f+45)),h=sin(this.angle+l*(90*f+45));this.corners[f]=new a(g,h)}this.Update=function(a){this.time+=a,this.rotation+=this.rotationSpeed*a,this.cosA=cos(l*this.rotation),this.pos.x+=cos(this.time*this.oscillationSpeed)*this.xSpeed*a,this.pos.y+=this.ySpeed*a,this.pos.y>c.bounds.y&&(this.pos.x=random()*c.bounds.x,this.pos.y=0)},this.Draw=function(a){this.cosA>0?a.fillStyle=this.frontColor:a.fillStyle=this.backColor,a.beginPath(),a.moveTo((this.pos.x+this.corners[0].x*this.size)*retina,(this.pos.y+this.corners[0].y*this.size*this.cosA)*retina);for(var b=1;4>b;b++)a.lineTo((this.pos.x+this.corners[b].x*this.size)*retina,(this.pos.y+this.corners[b].y*this.size*this.cosA)*retina);a.closePath(),a.fill()}}function d(c,e,f,g,h,i,j,k){this.particleDist=g,this.particleCount=f,this.particleMass=j,this.particleDrag=k,this.particles=new Array;var n=round(random()*(m.length-1));this.frontColor=m[n][0],this.backColor=m[n][1],this.xOff=cos(l*i)*h,this.yOff=sin(l*i)*h,this.position=new a(c,e),this.prevPosition=new a(c,e),this.velocityInherit=2*random()+4,this.time=100*random(),this.oscillationSpeed=2*random()+2,this.oscillationDistance=40*random()+40,this.ySpeed=40*random()+80;for(var o=0;o<this.particleCount;o++)this.particles[o]=new b(c,e-o*this.particleDist,this.particleMass,this.particleDrag);this.Update=function(b){var c=0;this.time+=b*this.oscillationSpeed,this.position.y+=this.ySpeed*b,this.position.x+=cos(this.time)*this.oscillationDistance*b,this.particles[0].position=this.position;var e=this.prevPosition.x-this.position.x,f=this.prevPosition.y-this.position.y,g=sqrt(e*e+f*f);for(this.prevPosition=new a(this.position.x,this.position.y),c=1;c<this.particleCount;c++){var h=a.Sub(this.particles[c-1].position,this.particles[c].position);h.Normalize(),h.Mul(g/b*this.velocityInherit),this.particles[c].AddForce(h)}for(c=1;c<this.particleCount;c++)this.particles[c].Integrate(b);for(c=1;c<this.particleCount;c++){var i=new a(this.particles[c].position.x,this.particles[c].position.y);i.Sub(this.particles[c-1].position),i.Normalize(),i.Mul(this.particleDist),i.Add(this.particles[c-1].position),this.particles[c].position=i}this.position.y>d.bounds.y+this.particleDist*this.particleCount&&this.Reset()},this.Reset=function(){this.position.y=-random()*d.bounds.y,this.position.x=random()*d.bounds.x,this.prevPosition=new a(this.position.x,this.position.y),this.velocityInherit=2*random()+4,this.time=100*random(),this.oscillationSpeed=2*random()+1.5,this.oscillationDistance=40*random()+40,this.ySpeed=40*random()+80;var c=round(random()*(m.length-1));this.frontColor=m[c][0],this.backColor=m[c][1],this.particles=new Array;for(var e=0;e<this.particleCount;e++)this.particles[e]=new b(this.position.x,this.position.y-e*this.particleDist,this.particleMass,this.particleDrag)},this.Draw=function(b){for(var c=0;c<this.particleCount-1;c++){var d=new a(this.particles[c].position.x+this.xOff,this.particles[c].position.y+this.yOff),e=new a(this.particles[c+1].position.x+this.xOff,this.particles[c+1].position.y+this.yOff);this.Side(this.particles[c].position.x,this.particles[c].position.y,this.particles[c+1].position.x,this.particles[c+1].position.y,e.x,e.y)<0?(b.fillStyle=this.frontColor,b.strokeStyle=this.frontColor):(b.fillStyle=this.backColor,b.strokeStyle=this.backColor),0==c?(b.beginPath(),b.moveTo(this.particles[c].position.x*retina,this.particles[c].position.y*retina),b.lineTo(this.particles[c+1].position.x*retina,this.particles[c+1].position.y*retina),b.lineTo(.5*(this.particles[c+1].position.x+e.x)*retina,.5*(this.particles[c+1].position.y+e.y)*retina),b.closePath(),b.stroke(),b.fill(),b.beginPath(),b.moveTo(e.x*retina,e.y*retina),b.lineTo(d.x*retina,d.y*retina),b.lineTo(.5*(this.particles[c+1].position.x+e.x)*retina,.5*(this.particles[c+1].position.y+e.y)*retina),b.closePath(),b.stroke(),b.fill()):c==this.particleCount-2?(b.beginPath(),b.moveTo(this.particles[c].position.x*retina,this.particles[c].position.y*retina),b.lineTo(this.particles[c+1].position.x*retina,this.particles[c+1].position.y*retina),b.lineTo(.5*(this.particles[c].position.x+d.x)*retina,.5*(this.particles[c].position.y+d.y)*retina),b.closePath(),b.stroke(),b.fill(),b.beginPath(),b.moveTo(e.x*retina,e.y*retina),b.lineTo(d.x*retina,d.y*retina),b.lineTo(.5*(this.particles[c].position.x+d.x)*retina,.5*(this.particles[c].position.y+d.y)*retina),b.closePath(),b.stroke(),b.fill()):(b.beginPath(),b.moveTo(this.particles[c].position.x*retina,this.particles[c].position.y*retina),b.lineTo(this.particles[c+1].position.x*retina,this.particles[c+1].position.y*retina),b.lineTo(e.x*retina,e.y*retina),b.lineTo(d.x*retina,d.y*retina),b.closePath(),b.stroke(),b.fill())}},this.Side=function(a,b,c,d,e,f){return(a-c)*(f-d)-(b-d)*(e-c)}}var e=50,f=1/e,g=11,h=30,i=8,j=8,k=95,l=PI/180,m=[["#df0049","#660671"],["#00e857","#005291"],["#2bebbc","#05798a"],["#ffd200","#b06c00"]];a.Lerp=function(b,c,d){return new a((c.x-b.x)*d+b.x,(c.y-b.y)*d+b.y)},a.Distance=function(b,c){return sqrt(a.SqrDistance(b,c))},a.SqrDistance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d+z*z},a.Scale=function(b,c){return new a(b.x*c.x,b.y*c.y)},a.Min=function(b,c){return new a(Math.min(b.x,c.x),Math.min(b.y,c.y))},a.Max=function(b,c){return new a(Math.max(b.x,c.x),Math.max(b.y,c.y))},a.ClampMagnitude=function(b,c){var d=b.Normalized;return new a(d.x*c,d.y*c)},a.Sub=function(b,c){return new a(b.x-c.x,b.y-c.y,b.z-c.z)},c.bounds=new a(0,0),d.bounds=new a(0,0),n={},n.Context=function(b){var e=0,l=document.getElementById(b),m=l.parentNode,o=m.offsetWidth,p=m.offsetHeight;l.width=o*retina,l.height=p*retina;var q=l.getContext("2d"),r=new Array;for(d.bounds=new a(o,p),e=0;g>e;e++)r[e]=new d(random()*o,-random()*p*2,h,i,j,45,1,.05);var s=new Array;for(c.bounds=new a(o,p),e=0;k>e;e++)s[e]=new c(random()*o,random()*p);this.resize=function(){o=m.offsetWidth,p=m.offsetHeight,l.width=o*retina,l.height=p*retina,c.bounds=new a(o,p),d.bounds=new a(o,p)},this.start=function(){this.stop();this.update()},this.stop=function(){cAF(this.interval)},this.update=function(){var a=0;for(q.clearRect(0,0,l.width,l.height),a=0;k>a;a++)s[a].Update(f),s[a].Draw(q);for(a=0;g>a;a++)r[a].Update(f),r[a].Draw(q);this.interval=rAF(function(){n.update()})}};var n=new n.Context("confetti");n.start(),window.addEventListener("resize",function(a){n.resize()})}angular.module("bingoApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"BingoCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("bingoApp").controller("BingoCtrl",BingoCtrl),BingoCtrl.$inject=["$http"];var retina=window.devicePixelRatio,PI=Math.PI,sqrt=Math.sqrt,round=Math.round,random=Math.random,cos=Math.cos,sin=Math.sin,rAF=window.requestAnimationFrame,cAF=window.cancelAnimationFrame||window.cancelRequestAnimationFrame,_now=Date.now||function(){return(new Date).getTime()};!function(a){function b(a){var b=_now(),d=Math.max(0,16-(b-c)),e=setTimeout(a,d);return c=b,e}var c=_now(),d=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.clearTimeout;rAF=a.requestAnimationFrame||a.webkitRequestAnimationFrame||b,cAF=function(b){d.call(a,b)}}(window),angular.module("bingoApp").run(["$templateCache",function(a){a.put("views/main.html",'<div class="grid-wrapper" ng-controller="BingoCtrl as bingo"> <canvas id="confetti" width="100%" height="100%" ng-show="bingo.confetti" class="ng-hide" ng-click="bingo.reset()"></canvas> <audio id="audiotag1" src="assets/party_horn.mp3" preload="auto"></audio> <div class="tileRow"> <div class="tile title"><p>B</p></div><div class="tile title"><p>I</p></div><div class="tile title"><p>N</p></div><div class="tile title"><p>G</p></div><div class="tile title"><p>O</p></div> </div> <div class="tileRow" ng-repeat="rows in bingo.grid"> <div class="tile" ng-class="{tileSelected:  tile.hit, FishMoley: tile.phrase === bingo.bingoInfo.freeSpace}" ng-repeat="tile in rows" ng-click="bingo.selectTile(tile)"><p>{{tile.phrase}}</p></div> </div> </div>')}]);